"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[8274],{8274:(j,m,d)=>{d.r(m),d.d(m,{MyRequestsModule:()=>ne});var u=d(177),r=d(2791),y=d(4412),q=d(1594),E=d(5098),e=d(4438),I=d(8600),S=d(7112),R=d(6781),h=d(9417),b=d(1579),T=d(3955);const x=()=>({width:"50rem"}),F=()=>({height:"4px"}),o=(s,l,t)=>({"badge-light-warning":s,"badge-light-success":l,"badge-light-danger":t}),_=(s,l)=>({"bi-building":s,"bi-person":l}),c=()=>({"background-color":"#EEF6FF",color:"#3E97FF"});function p(s,l){1&s&&e.nrm(0,"p-progressBar",9),2&s&&e.Aen(e.lJ4(2,F))}function g(s,l){1&s&&(e.j41(0,"div",10)(1,"div",11)(2,"div",12)(3,"span",13),e.EFF(4,"Loading..."),e.k0s()(),e.j41(5,"h3",14),e.EFF(6,"Loading Requests"),e.k0s(),e.j41(7,"p",15),e.EFF(8,"Please wait while we fetch your requests..."),e.k0s()()())}function k(s,l){1&s&&(e.j41(0,"div",16)(1,"div",11),e.nrm(2,"img",17),e.j41(3,"h3",14),e.EFF(4,"No Requests Found"),e.k0s(),e.j41(5,"p",15),e.EFF(6,"You don't have any requests at the moment. New requests will appear here once created."),e.k0s()()())}function v(s,l){if(1&s&&(e.j41(0,"div",44),e.nrm(1,"img",53),e.k0s()),2&s){const t=e.XpG().$implicit;e.R7$(),e.FS9("src",t.requestable.profile_photo_url,e.B4B)}}function C(s,l){if(1&s&&(e.j41(0,"div",44),e.nrm(1,"i",54),e.k0s()),2&s){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngClass",e.l_i(1,_,"company"===t.requestable_type,"userinsighter"===t.requestable_type))}}function M(s,l){if(1&s&&(e.qex(0),e.EFF(1),e.bVm()),2&s){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.requestable.legal_name," ")}}function w(s,l){if(1&s&&(e.qex(0),e.EFF(1),e.bVm()),2&s){const t=e.XpG().$implicit;e.R7$(),e.Lme(" ",t.requestable.first_name," ",t.requestable.last_name," ")}}function D(s,l){if(1&s){const t=e.RV6();e.j41(0,"div",39)(1,"div",40),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG(3);return e.Njj(a.openRequestDialog(i))}),e.j41(2,"div",41)(3,"div",42)(4,"div",43),e.DNE(5,v,2,1,"div",44)(6,C,2,4),e.j41(7,"div")(8,"div",45),e.DNE(9,M,2,1,"ng-container",46)(10,w,2,2,"ng-container",46),e.k0s(),e.j41(11,"div",47),e.EFF(12),e.k0s()()(),e.j41(13,"div",48)(14,"span",49),e.EFF(15),e.k0s()(),e.j41(16,"div",48)(17,"div",50),e.EFF(18),e.nI1(19,"uppercase"),e.nI1(20,"translate"),e.k0s()(),e.j41(21,"div",43)(22,"button",51),e.bIt("click",function(i){const a=e.eBV(t).$implicit;return e.XpG(3).openRequestDialog(a),e.Njj(i.stopPropagation())}),e.nrm(23,"i",52),e.EFF(24),e.nI1(25,"translate"),e.k0s()()()()()()}if(2&s){const t=l.$implicit;e.R7$(5),e.vxM(5,t.requestable.profile_photo_url?5:6),e.R7$(4),e.Y8G("ngIf","company"===t.requestable_type),e.R7$(),e.Y8G("ngIf","userinsighter"===t.requestable_type),e.R7$(2),e.JRh(t.comments||"No comments"),e.R7$(3),e.JRh(t.type.label),e.R7$(2),e.Y8G("ngClass",e.sMw(14,o,"pending"===t.final_status,"approved"===t.final_status,"declined"===t.final_status)),e.R7$(),e.SpI(" ",e.bMT(20,10,"USER_REQUESTS.FILTER."+e.bMT(19,8,t.final_status))," "),e.R7$(6),e.SpI(" ",e.bMT(25,12,"USER_REQUESTS.DIALOG.VIEW")," ")}}function G(s,l){if(1&s&&(e.j41(0,"div",37),e.DNE(1,D,26,18,"div",38),e.k0s()),2&s){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.filteredUserRequests)}}function $(s,l){if(1&s){const t=e.RV6();e.j41(0,"div",55)(1,"div",56),e.nrm(2,"i",57),e.j41(3,"h4",14),e.EFF(4,"No Matching Requests"),e.k0s(),e.j41(5,"p",15),e.EFF(6,"No requests match your current filter criteria."),e.k0s(),e.j41(7,"button",58),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.clearUserFilters())}),e.nrm(8,"i",59),e.EFF(9," Clear Filters "),e.k0s()()()}}function N(s,l){if(1&s){const t=e.RV6();e.j41(0,"div",18)(1,"div",19)(2,"h3",20)(3,"span",21),e.EFF(4),e.nI1(5,"translate"),e.k0s(),e.j41(6,"span",22)(7,"span",23),e.EFF(8),e.k0s(),e.EFF(9),e.nI1(10,"translate"),e.k0s()(),e.j41(11,"div",24)(12,"div",25)(13,"div",26)(14,"div",27),e.nrm(15,"i",28),e.EFF(16),e.nI1(17,"translate"),e.k0s(),e.j41(18,"select",29),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.selectedStatus,i)||(a.selectedStatus=i),e.Njj(i)}),e.bIt("change",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.filterRequests())}),e.j41(19,"option",30),e.EFF(20),e.nI1(21,"translate"),e.k0s(),e.j41(22,"option",31),e.EFF(23),e.nI1(24,"translate"),e.k0s(),e.j41(25,"option",32),e.EFF(26),e.nI1(27,"translate"),e.k0s(),e.j41(28,"option",33),e.EFF(29),e.nI1(30,"translate"),e.k0s()()()()()(),e.j41(31,"div",34),e.DNE(32,G,2,1,"div",35)(33,$,10,0,"div",36),e.nI1(34,"async"),e.k0s()()}if(2&s){const t=e.XpG();e.R7$(4),e.JRh(e.bMT(5,11,"USER_REQUESTS.TITLE")),e.R7$(4),e.JRh(t.userRequests.length),e.R7$(),e.SpI(" ",e.bMT(10,13,"USER_REQUESTS.REQUEST_COUNT")," "),e.R7$(7),e.JRh(e.bMT(17,15,"USER_REQUESTS.FILTER.STATUS_TITLE")),e.R7$(2),e.R50("ngModel",t.selectedStatus),e.R7$(2),e.JRh(e.bMT(21,17,"USER_REQUESTS.FILTER.SHOW_ALL")),e.R7$(3),e.JRh(e.bMT(24,19,"USER_REQUESTS.FILTER.PENDING")),e.R7$(3),e.JRh(e.bMT(27,21,"USER_REQUESTS.FILTER.APPROVED")),e.R7$(3),e.JRh(e.bMT(30,23,"USER_REQUESTS.FILTER.REJECTED")),e.R7$(3),e.Y8G("ngIf",t.filteredUserRequests.length>0),e.R7$(),e.Y8G("ngIf",!e.bMT(34,25,t.isLoading$)&&0===t.filteredUserRequests.length&&t.hasUserFilters())}}function U(s,l){if(1&s){const t=e.RV6();e.j41(0,"div",24)(1,"div",25)(2,"div",26)(3,"div",27),e.nrm(4,"i",28),e.EFF(5),e.nI1(6,"translate"),e.k0s(),e.j41(7,"select",29),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG(2);return e.DH7(a.selectedInsighterStatus,i)||(a.selectedInsighterStatus=i),e.Njj(i)}),e.bIt("change",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.filterInsighterRequests())}),e.j41(8,"option",30),e.EFF(9),e.nI1(10,"translate"),e.k0s(),e.j41(11,"option",31),e.EFF(12),e.nI1(13,"translate"),e.k0s(),e.j41(14,"option",32),e.EFF(15),e.nI1(16,"translate"),e.k0s(),e.j41(17,"option",33),e.EFF(18),e.nI1(19,"translate"),e.k0s()()()()()}if(2&s){const t=e.XpG(2);e.R7$(5),e.JRh(e.bMT(6,6,"INSIGHTER_REQUESTS.FILTER.STATUS")),e.R7$(2),e.R50("ngModel",t.selectedInsighterStatus),e.R7$(2),e.JRh(e.bMT(10,8,"USER_REQUESTS.FILTER.SHOW_ALL")),e.R7$(3),e.JRh(e.bMT(13,10,"USER_REQUESTS.FILTER.PENDING")),e.R7$(3),e.JRh(e.bMT(16,12,"USER_REQUESTS.FILTER.APPROVED")),e.R7$(3),e.JRh(e.bMT(19,14,"USER_REQUESTS.FILTER.REJECTED"))}}function L(s,l){if(1&s&&(e.j41(0,"div",68),e.nrm(1,"img",69),e.k0s()),2&s){const t=e.XpG(2).$implicit;e.R7$(),e.Y8G("src",t.requestable.profile_photo_url,e.B4B)}}function A(s,l){if(1&s&&(e.j41(0,"div",70),e.EFF(1),e.nI1(2,"slice"),e.nI1(3,"slice"),e.k0s()),2&s){const t=e.XpG(2).$implicit;e.Y8G("ngStyle",e.lJ4(11,c)),e.R7$(),e.Lme(" ",e.brH(2,3,t.requestable.name,0,1),"",e.brH(3,7,t.requestable.name&&t.requestable.name.indexOf(" ")>-1?t.requestable.name.split(" ")[1]:"",0,1)," ")}}function B(s,l){if(1&s&&(e.j41(0,"div",65),e.DNE(1,L,2,1,"div",66)(2,A,4,12,"div",67),e.k0s()),2&s){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",t.requestable.profile_photo_url),e.R7$(),e.Y8G("ngIf",!t.requestable.profile_photo_url&&t.requestable.name)}}function V(s,l){if(1&s){const t=e.RV6();e.j41(0,"div",39)(1,"div",40),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG(3);return e.Njj(a.openInsighterRequestDialog(i))}),e.j41(2,"div",41)(3,"div",42)(4,"div",43),e.DNE(5,B,3,2,"div",62),e.j41(6,"div")(7,"div",63),e.EFF(8),e.k0s(),e.j41(9,"div",47),e.EFF(10),e.k0s()()(),e.j41(11,"div",48)(12,"span",49),e.EFF(13),e.k0s()(),e.j41(14,"div",48)(15,"div",50),e.EFF(16),e.nI1(17,"uppercase"),e.nI1(18,"translate"),e.k0s()(),e.j41(19,"div",64)(20,"button",51),e.bIt("click",function(i){const a=e.eBV(t).$implicit;return e.XpG(3).openInsighterRequestDialog(a),e.Njj(i.stopPropagation())}),e.nrm(21,"i",52),e.EFF(22),e.nI1(23,"translate"),e.k0s()()()()()()}if(2&s){const t=l.$implicit;e.R7$(5),e.Y8G("ngIf",t.requestable),e.R7$(3),e.JRh(t.requestable.name||"Unknown"),e.R7$(2),e.JRh(t.comments||"No comments"),e.R7$(3),e.JRh(t.type.label),e.R7$(2),e.Y8G("ngClass",e.sMw(13,o,"pending"===t.final_status,"approved"===t.final_status,"declined"===t.final_status)),e.R7$(),e.SpI(" ",e.bMT(18,9,"USER_REQUESTS.STATUS."+e.bMT(17,7,t.final_status))," "),e.R7$(6),e.SpI(" ",e.bMT(23,11,"USER_REQUESTS.DIALOG.VIEW")," ")}}function P(s,l){if(1&s&&(e.j41(0,"div",37),e.DNE(1,V,24,17,"div",38),e.k0s()),2&s){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.filteredInsighterRequests)}}function Y(s,l){if(1&s){const t=e.RV6();e.j41(0,"div",55)(1,"div",56),e.nrm(2,"i",57),e.j41(3,"h4",14),e.EFF(4,"No Matching Requests"),e.k0s(),e.j41(5,"p",15),e.EFF(6,"No insighter requests match your current filter criteria."),e.k0s(),e.j41(7,"button",71),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.clearInsighterFilters())}),e.nrm(8,"i",59),e.EFF(9," Clear Filters "),e.k0s()()()}}function X(s,l){if(1&s&&(e.j41(0,"div",60)(1,"div",19)(2,"h3",20)(3,"span",21),e.EFF(4),e.nI1(5,"translate"),e.k0s(),e.j41(6,"span",22)(7,"span",23),e.EFF(8),e.k0s(),e.EFF(9),e.nI1(10,"translate"),e.k0s()(),e.DNE(11,U,20,16,"div",61),e.k0s(),e.j41(12,"div",34),e.DNE(13,P,2,1,"div",35)(14,Y,10,0,"div",36),e.nI1(15,"async"),e.k0s()()),2&s){const t=e.XpG();e.R7$(4),e.JRh(e.bMT(5,6,"INSIGHTER_REQUESTS.TITLE")),e.R7$(4),e.JRh(t.insighterRequests.length),e.R7$(),e.SpI(" ",e.bMT(10,8,"INSIGHTER_REQUESTS.REQUEST_COUNT")," "),e.R7$(2),e.Y8G("ngIf",t.insighterRequests.length>0),e.R7$(2),e.Y8G("ngIf",t.filteredInsighterRequests.length>0),e.R7$(),e.Y8G("ngIf",!e.bMT(15,10,t.isLoading$)&&0===t.filteredInsighterRequests.length&&t.hasInsighterFilters())}}function O(s,l){if(1&s&&(e.j41(0,"div",78)(1,"h6",79),e.nrm(2,"i",80),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.j41(5,"div",81)(6,"p",82),e.EFF(7),e.nI1(8,"translate"),e.k0s()()()),2&s){const t=e.XpG(2);e.R7$(3),e.SpI(" ",e.bMT(4,2,"USER_REQUESTS.DIALOG.STAFF_NOTES_LABEL")," "),e.R7$(4),e.SpI(" ",t.selectedRequest.staff_notes||e.bMT(8,4,"USER_REQUESTS.DIALOG.NO_STAFF_NOTES")," ")}}function Q(s,l){if(1&s){const t=e.RV6();e.j41(0,"div",86)(1,"button",87),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.navigateToReview())}),e.nrm(2,"i",88),e.EFF(3," Review Knowledge "),e.k0s()()}}function J(s,l){if(1&s){const t=e.RV6();e.j41(0,"div",89)(1,"button",90),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.onApproveRequest())}),e.nrm(2,"i",91),e.EFF(3," Approve "),e.k0s(),e.j41(4,"button",92),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.onDeclineRequest())}),e.nrm(5,"i",93),e.EFF(6," Decline "),e.k0s()()}}function H(s,l){if(1&s&&(e.j41(0,"div",83),e.DNE(1,Q,4,0,"div",84)(2,J,7,0,"div",85),e.k0s()),2&s){const t=e.XpG(2);e.R7$(),e.Y8G("ngIf","accept_knowledge"===(null==t.selectedRequest.type?null:t.selectedRequest.type.key)&&t.selectedRequest.knowledge_id),e.R7$(),e.Y8G("ngIf",!(null!=t.selectedRequest.type&&t.selectedRequest.type.key)||"accept_knowledge"!==(null==t.selectedRequest.type?null:t.selectedRequest.type.key))}}function z(s,l){if(1&s){const t=e.RV6();e.j41(0,"div",94)(1,"div",95)(2,"h5",96),e.nrm(3,"i",97),e.EFF(4," Staff Notes "),e.k0s()(),e.j41(5,"div",98)(6,"textarea",99),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG(2);return e.DH7(a.staffNotes,i)||(a.staffNotes=i),e.Njj(i)}),e.k0s()(),e.j41(7,"div",100)(8,"div",101)(9,"button",102),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.confirmAction())}),e.nrm(10,"i",103),e.EFF(11),e.k0s(),e.j41(12,"button",104),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.cancelAction())}),e.nrm(13,"i",105),e.EFF(14),e.nI1(15,"translate"),e.k0s()()()()}if(2&s){const t=e.XpG(2);e.R7$(6),e.R50("ngModel",t.staffNotes),e.R7$(3),e.HbH(t.isApproving?"btn btn-success  flex-grow-1":"btn btn-danger  flex-grow-1"),e.Y8G("disabled",!t.staffNotes),e.R7$(),e.Y8G("ngClass",t.isApproving?"bi-check-lg":"bi-x-lg"),e.R7$(),e.SpI(" ",t.isApproving?"Confirm Approval":"Confirm Decline"," "),e.R7$(3),e.SpI(" ",e.bMT(15,7,"CANCEL")," ")}}function K(s,l){if(1&s&&(e.j41(0,"div",72)(1,"h3",73),e.EFF(2),e.k0s(),e.j41(3,"div",73)(4,"div",74),e.EFF(5),e.nI1(6,"titlecase"),e.k0s()(),e.DNE(7,O,9,6,"div",75)(8,H,3,2,"div",76)(9,z,16,9,"div",77),e.k0s()),2&s){const t=e.XpG();e.R7$(2),e.JRh(t.selectedRequest.type.label),e.R7$(2),e.Y8G("ngClass",e.sMw(8,o,"pending"===t.selectedRequest.final_status,"approved"===t.selectedRequest.final_status,"declined"===t.selectedRequest.final_status)),e.R7$(),e.SpI(" ",e.bMT(6,6,t.selectedRequest.final_status)," "),e.R7$(2),e.Y8G("ngIf","pending"!==t.selectedRequest.final_status),e.R7$(),e.Y8G("ngIf","pending"===t.selectedRequest.final_status&&t.isInsighterRequest),e.R7$(),e.Y8G("ngIf","pending"===t.selectedRequest.final_status&&t.isInsighterRequest&&(t.isApproving||t.isDeclining))}}function W(s,l){if(1&s){const t=e.RV6();e.qex(0),e.j41(1,"button",109),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.viewKnowledge())}),e.EFF(2," View Knowledge "),e.k0s(),e.bVm()}}function Z(s,l){if(1&s){const t=e.RV6();e.j41(0,"div",106)(1,"div",95)(2,"h5",96),e.EFF(3),e.nI1(4,"translate"),e.k0s()(),e.j41(5,"div",98)(6,"textarea",107),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.resendComments,i)||(a.resendComments=i),e.Njj(i)}),e.k0s()(),e.j41(7,"div",100)(8,"button",108),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onResendRequest())}),e.EFF(9," Resend Request "),e.k0s(),e.DNE(10,W,3,0,"ng-container",46),e.k0s()()}if(2&s){const t=e.XpG();e.R7$(3),e.SpI(" ",e.bMT(4,4,"USER_REQUESTS.DIALOG.RESEND_REQUEST")," "),e.R7$(3),e.R50("ngModel",t.resendComments),e.R7$(2),e.Y8G("disabled",!t.resendComments),e.R7$(2),e.Y8G("ngIf","accept_knowledge"===(null==t.selectedRequest||null==t.selectedRequest.type?null:t.selectedRequest.type.key)&&(null==t.selectedRequest?null:t.selectedRequest.identity))}}function ee(s,l){1&s&&(e.j41(0,"div",110)(1,"div",43),e.nrm(2,"i",111),e.j41(3,"span"),e.EFF(4),e.nI1(5,"translate"),e.k0s()()()),2&s&&(e.R7$(4),e.JRh(e.bMT(5,1,"USER_REQUESTS.DIALOG.PENDING_REQUEST_EXISTS")))}let te=(()=>{class s extends E.${userRequestsService;getProfileService;router;userRequests=[];filteredUserRequests=[];insighterRequests=[];filteredInsighterRequests=[];isLoading$;loadingSubject=new y.t(!0);selectedType="";selectedStatus="";selectedInsighterType="";selectedInsighterStatus="";resendComments="";displayRequestDialog=!1;selectedRequest=null;userProfile=null;hasPendingRequestOfSameType=!1;profileLoaded=!1;userRequestsLoaded=!1;insighterRequestsLoaded=!1;isInsighterRequest=!1;isApproving=!1;isDeclining=!1;staffNotes="";constructor(t,n,i,a){super(t),this.userRequestsService=n,this.getProfileService=i,this.router=a,this.isLoading$=this.loadingSubject.asObservable()}ngOnInit(){this.loadingSubject.next(!0),this.loadData(),this.getProfile()}getProfile(){this.getProfileService.getProfile().pipe((0,q.$)()).subscribe({next:t=>{console.log("User profile loaded:",t),console.log("User roles:",t?.roles),this.userProfile=t,this.profileLoaded=!0,t?.roles.includes("company")?this.loadInsighterRequests():(this.insighterRequestsLoaded=!0,this.checkLoadingComplete())},error:t=>{console.error("Error loading profile:",t),this.profileLoaded=!0,this.checkLoadingComplete()}})}loadData(){this.userRequestsService.getAllUserRequests(this.lang).subscribe({next:t=>{this.userRequests=t,this.filterRequests(),this.userRequestsLoaded=!0,this.checkLoadingComplete()},error:t=>{console.error("Error loading user requests:",t),this.userRequestsLoaded=!0,this.checkLoadingComplete()}})}loadInsighterRequests(){console.log("Loading insighter requests..."),this.userRequestsService.getInsighterRequests(this.lang).subscribe({next:t=>{console.log("Insighter requests loaded:",t),this.insighterRequests=t,this.filterInsighterRequests(),this.insighterRequestsLoaded=!0,this.checkLoadingComplete()},error:t=>{console.error("Error loading insighter requests:",t),this.insighterRequestsLoaded=!0,this.checkLoadingComplete()}})}checkLoadingComplete(){this.profileLoaded&&this.userRequestsLoaded&&this.insighterRequestsLoaded&&this.loadingSubject.next(!1)}filterRequests(){this.filteredUserRequests=this.userRequests.filter(t=>!(this.selectedType&&t.type.key!==this.selectedType||this.selectedStatus&&t.final_status!==this.selectedStatus))}filterInsighterRequests(){console.log("Filtering insighter requests. Total count:",this.insighterRequests.length),console.log("Current filters - Type:",this.selectedInsighterType,"Status:",this.selectedInsighterStatus),this.filteredInsighterRequests=this.insighterRequests.filter(t=>!(this.selectedInsighterType&&t.type.key!==this.selectedInsighterType||this.selectedInsighterStatus&&t.final_status!==this.selectedInsighterStatus)),console.log("Filtered insighter requests count:",this.filteredInsighterRequests.length)}hasActiveFilters(){return this.hasUserFilters()||this.hasInsighterFilters()}hasUserFilters(){return!!this.selectedType||!!this.selectedStatus}hasInsighterFilters(){return!!this.selectedInsighterType||!!this.selectedInsighterStatus}clearUserFilters(){this.selectedType="",this.selectedStatus="",this.filterRequests()}clearInsighterFilters(){this.selectedInsighterType="",this.selectedInsighterStatus="",this.filterInsighterRequests()}openRequestDialog(t){const n=this.getLatestChild(t);this.selectedRequest=n,this.isInsighterRequest=!1,this.hasPendingRequestOfSameType=this.userRequests.some(i=>i.type.key===n.type.key&&"pending"===i.final_status&&i.id!==n.id),this.displayRequestDialog=!0}openInsighterRequestDialog(t){const n=this.getLatestChild(t);if("accept_knowledge"===n.type?.key&&n.identity)return this.selectedRequest=n,void this.navigateToReview();this.selectedRequest=n,this.isInsighterRequest=!0,this.isApproving=!1,this.isDeclining=!1,this.staffNotes="",this.hasPendingRequestOfSameType=this.insighterRequests.some(i=>i.type.key===n.type.key&&"pending"===i.final_status&&i.id!==n.id),this.displayRequestDialog=!0}onApproveRequest(){this.isApproving=!0,this.isDeclining=!1}onDeclineRequest(){this.isApproving=!1,this.isDeclining=!0}cancelAction(){this.isApproving=!1,this.isDeclining=!1,this.staffNotes=""}confirmAction(){!this.selectedRequest||!this.staffNotes.trim()||(this.isApproving?this.approveInsighterRequest():this.isDeclining&&this.declineInsighterRequest())}approveInsighterRequest(){if(!this.selectedRequest||!this.staffNotes.trim())return;const t=this.selectedRequest.id.toString();this.loadingSubject.next(!0),this.userRequestsService.updateInsighterRequestStatus(t,"approved",this.staffNotes).subscribe({next:()=>{this.showSuccess("Success","Request approved successfully"),this.displayRequestDialog=!1,this.userProfile?.roles.includes("company")?this.loadInsighterRequests():this.loadData(),this.resetActionState()},error:i=>{console.error("Error approving request:",i),this.showError("Error","Failed to approve request"),this.loadingSubject.next(!1)}})}declineInsighterRequest(){if(!this.selectedRequest||!this.staffNotes.trim())return;const t=this.selectedRequest.id.toString();this.loadingSubject.next(!0),this.userRequestsService.updateInsighterRequestStatus(t,"declined",this.staffNotes).subscribe({next:()=>{this.showSuccess("Success","Request declined successfully"),this.displayRequestDialog=!1,this.userProfile?.roles.includes("company")?this.loadInsighterRequests():this.loadData(),this.resetActionState()},error:i=>{console.error("Error declining request:",i),this.showError("Error","Failed to decline request"),this.loadingSubject.next(!1)}})}resetActionState(){this.isApproving=!1,this.isDeclining=!1,this.staffNotes="",this.selectedRequest=null}viewFilteredStock(){}getLatestChild(t){let n=t;if(t.children&&t.children.length>0)for(const i of t.children){const a=this.getLatestChild(i);a.id>n.id&&(n=a)}return n}onResendRequest(){if(this.selectedRequest?.id&&this.resendComments.trim())if(this.loadingSubject.next(!0),"activate_company"===this.selectedRequest.type.key){const t=this.userRequestsService.sendActivationRequest(this.resendComments,this.selectedRequest.id.toString()).subscribe({next:()=>{this.showSuccess("Success","Verification request resent successfully."),this.loadData(),this.displayRequestDialog=!1,this.resendComments=""},error:n=>{console.error("Error resending verification request:",n),this.showError("Error","Failed to resend verification request."),this.loadingSubject.next(!1)}});this.unsubscribe.push(t)}else if("verified_company"===this.selectedRequest?.type.key){const t=this.userRequestsService.sendVerificationRequest(this.resendComments,this.selectedRequest.id.toString()).subscribe({next:()=>{this.showSuccess("Success","Activation request resent successfully."),this.loadData(),this.displayRequestDialog=!1,this.resendComments=""},error:n=>{console.error("Error resending activation request:",n),this.showError("Error","Failed to resend activation request."),this.loadingSubject.next(!1)}});this.unsubscribe.push(t)}else if("deactivate_delete_company"===this.selectedRequest?.type.key){const t=this.userRequestsService.sendDeactivateAndDeleteRequest(this.resendComments,this.selectedRequest.id.toString()).subscribe({next:()=>{this.showSuccess("Success","Deactivation request sent successfully."),this.loadData(),this.displayRequestDialog=!1,this.resendComments=""},error:n=>{this.loadingSubject.next(!1)}});this.unsubscribe.push(t)}else if("deactivate_delete_insighter"===this.selectedRequest?.type.key){const t=this.userRequestsService.sendDeactivateAndDeleteRequestInsighter(this.resendComments,this.selectedRequest.id.toString()).subscribe({next:()=>{this.showSuccess("Success","Deactivation request sent successfully."),this.loadData(),this.displayRequestDialog=!1,this.resendComments=""},error:n=>{this.loadingSubject.next(!1)}});this.unsubscribe.push(t)}else if("accept_knowledge"===this.selectedRequest?.type.key&&this.selectedRequest.identity){const t=this.userRequestsService.sendKnowledgeReviewRequest(this.resendComments,this.selectedRequest.id.toString(),this.selectedRequest.identity).subscribe({next:()=>{this.showSuccess("Success","Knowledge review request sent successfully."),this.loadData(),this.userProfile?.roles.includes("company")?this.loadInsighterRequests():this.loadData(),this.displayRequestDialog=!1,this.resendComments=""},error:n=>{console.error("Error sending knowledge review request:",n),this.showError("Error","Failed to send knowledge review request."),this.loadingSubject.next(!1)}});this.unsubscribe.push(t)}}navigateToReview(){this.selectedRequest?.identity&&(this.router.navigate(["/app/review-insighter-knowledge/review",this.selectedRequest.identity],{queryParams:{requestId:this.selectedRequest.id}}),this.displayRequestDialog=!1)}viewKnowledge(){this.selectedRequest?.identity&&(this.router.navigate(["/app/my-knowledge-base/view-my-knowledge/",parseInt(this.selectedRequest.identity),"details"]),this.displayRequestDialog=!1)}static \u0275fac=function(n){return new(n||s)(e.rXU(e.zZn),e.rXU(I.J),e.rXU(S.p),e.rXU(r.Ix))};static \u0275cmp=e.VBU({type:s,selectors:[["app-my-requests"]],features:[e.Vt3],decls:15,vars:27,consts:[["mode","indeterminate","styleClass","",3,"style",4,"ngIf"],["class","text-center py-10 bg-light rounded mb-5 border border-1 border-light",4,"ngIf"],["class","text-center py-10 bg-light-secondary rounded mb-5 border border-1 border-light",4,"ngIf"],["class","mb-5 mb-xl-10 card",4,"ngIf"],["class","mb-5 mb-xl-10 mt-10 card",4,"ngIf"],["appendTo","body",3,"visibleChange","header","visible","modal","closable"],["class","d-flex flex-column align-items-center",4,"ngIf"],["class","mt-5 w-100",4,"ngIf"],["class","mt-4 alert alert-warning  border",4,"ngIf"],["mode","indeterminate","styleClass",""],[1,"text-center","py-10","bg-light","rounded","mb-5","border","border-1","border-light"],[1,"my-5"],["role","status",1,"spinner-border","text-primary","mb-4",2,"width","3rem","height","3rem"],[1,"visually-hidden"],[1,"fw-bold","text-gray-800","mb-2"],[1,"text-gray-600","fs-6","px-3"],[1,"text-center","py-10","bg-light-secondary","rounded","mb-5","border","border-1","border-light"],["src","assets/media/illustrations/dozzy-1/7117863_3369471.svg","alt","No Requests Illustration",1,"mb-4",2,"max-width","300px"],[1,"mb-5","mb-xl-10","card"],[1,"card-header","pt-7","border-0"],[1,"card-title","align-items-start","flex-column"],[1,"fw-bolder","text-dark"],[1,"text-muted","mt-1","fw-semibold","fs-6"],[1,"badge","badge-light-info","mx-2"],[1,"card-toolbar"],[1,"d-flex","justify-content-end","flex-wrap","gap-4"],[1,"d-flex","align-items-center","fw-bold"],[1,"text-muted","fs-7","mx-2"],[1,"bi","bi-check-circle","mx-1"],[1,"form-select","form-select-sm","form-select-solid","text-gray-800","fs-7","lh-1","fw-bold","py-1","ps-3","w-auto",3,"ngModelChange","change","ngModel"],["value",""],["value","pending"],["value","approved"],["value","rejected"],[1,"card-body","pt-6","pb-4"],["class","row g-3",4,"ngIf"],["class","text-center py-8 bg-light-secondary rounded",4,"ngIf"],[1,"row","g-3"],["class","col-12",4,"ngFor","ngForOf"],[1,"col-12"],[1,"card","card-bordered","hover-elevate-up","cursor-pointer",3,"click"],[1,"card-body","py-3","px-4"],[1,"d-flex","align-items-center","justify-content-between"],[1,"d-flex","align-items-center"],[1,"symbol","symbol-40px","me-4","h-40px","w-40px","bg-light-info","d-flex","align-items-center","justify-content-center","rounded-circle"],[1,"fs-5","fw-bold","d-flex","align-items-center"],[4,"ngIf"],[1,"text-muted","fs-7"],[1,"d-none","d-md-flex","align-items-center","mx-4"],[1,"badge","badge-light-info","fs-7","fw-bold"],[1,"badge","badge-pill",3,"ngClass"],[1,"btn","btn-sm","btn-primary",3,"click"],[1,"bi","bi-eye-fill","mx-1"],["alt","User Image",1,"h-100","w-100","rounded-circle",2,"object-fit","cover","object-position","top",3,"src"],[1,"bi","fs-4",3,"ngClass"],[1,"text-center","py-8","bg-light-secondary","rounded"],[1,"my-3"],[1,"bi","bi-funnel","fs-1","text-gray-400","mb-3","d-block"],[1,"btn","btn-sm","btn-light-info","mt-2",3,"click"],[1,"bi","bi-x-circle","me-1"],[1,"mb-5","mb-xl-10","mt-10","card"],["class","card-toolbar",4,"ngIf"],["class","me-4",4,"ngIf"],[1,"fs-5","fw-bold"],[1,"d-flex","flex-shrink-0"],[1,"me-4"],["class","symbol symbol-40px w-40px h-40px overflow-hidden rounded-circle",4,"ngIf"],["class","symbol symbol-40px d-flex align-items-center h-40px w-40px justify-content-center rounded-circle",3,"ngStyle",4,"ngIf"],[1,"symbol","symbol-40px","w-40px","h-40px","overflow-hidden","rounded-circle"],["alt","Profile",1,"w-100","object-fit-cover",2,"object-position","top",3,"src"],[1,"symbol","symbol-40px","d-flex","align-items-center","h-40px","w-40px","justify-content-center","rounded-circle",3,"ngStyle"],[1,"btn","btn-sm","btn-light-primary","mt-2",3,"click"],[1,"d-flex","flex-column","align-items-center"],[1,"mb-4"],[1,"badge",3,"ngClass"],["class","w-100 mb-4",4,"ngIf"],["class","w-100 mt-3",4,"ngIf"],["class","w-100 mt-5",4,"ngIf"],[1,"w-100","mb-4"],[1,"fw-bold","mb-2"],[1,"bi","bi-chat-left-text","me-2"],[1,"bg-light-secondary","rounded","p-4"],[1,"text-gray-700","mb-0"],[1,"w-100","mt-3"],["class","text-center",4,"ngIf"],["class","d-flex gap-3 justify-content-center",4,"ngIf"],[1,"text-center"],["type","button",1,"btn","btn-primary","btn-lg","btn-icon-primary","w-75","mb-2",3,"click"],[1,"bi","bi-file-earmark-text","fs-4","mx-2"],[1,"d-flex","gap-3","justify-content-center"],["type","button",1,"btn","btn-light-success","btn-lg","px-6","py-3",3,"click"],[1,"bi","bi-check-circle-fill","fs-4","mx-2"],["type","button",1,"btn","btn-light-danger","btn-lg","px-6","py-3",3,"click"],[1,"bi","bi-x-circle-fill","fs-4","mx-2"],[1,"w-100","mt-5"],[1,"card-header","border-0","ps-0","pt-0"],[1,"card-title","fw-semibold","text-dark"],[1,"bi","bi-pencil-square","mx-2"],[1,"card-body","px-0"],["id","staffNotes","rows","4","placeholder","Enter your notes here...",1,"form-control","border-1",3,"ngModelChange","ngModel"],[1,"card-footer","border-0","px-0","pt-4","bg-transparent"],[1,"d-flex","gap-3"],["type","button",3,"click","disabled"],[1,"bi","fs-6","mx-2",3,"ngClass"],["type","button",1,"btn","btn-light","btn-active-light-secondary",3,"click"],[1,"bi","bi-arrow-left","fs-6","mx-2"],[1,"mt-5","w-100"],["id","resendComments","rows","4","placeholder","Please explain why you are resending this request...",1,"form-control","border-1",3,"ngModelChange","ngModel"],["type","button",1,"btn","btn-primary","btn-icon-primary","w-100",3,"click","disabled"],["type","button",1,"btn","btn-primary","btn-icon-primary","w-100","mt-4",3,"click"],[1,"mt-4","alert","alert-warning","border"],[1,"bi","bi-exclamation-triangle-fill","mx-2","fs-4","text-warning"]],template:function(n,i){1&n&&(e.DNE(0,p,1,3,"p-progressBar",0),e.nI1(1,"async"),e.DNE(2,g,9,0,"div",1),e.nI1(3,"async"),e.DNE(4,k,7,0,"div",2),e.nI1(5,"async"),e.DNE(6,N,35,27,"div",3),e.nI1(7,"async"),e.DNE(8,X,16,12,"div",4),e.nI1(9,"async"),e.j41(10,"p-dialog",5),e.nI1(11,"translate"),e.mxI("visibleChange",function(f){return e.DH7(i.displayRequestDialog,f)||(i.displayRequestDialog=f),f}),e.DNE(12,K,10,12,"div",6)(13,Z,11,6,"div",7)(14,ee,6,3,"div",8),e.k0s()),2&n&&(e.Y8G("ngIf",e.bMT(1,14,i.isLoading$)),e.R7$(2),e.Y8G("ngIf",e.bMT(3,16,i.isLoading$)),e.R7$(2),e.Y8G("ngIf",!e.bMT(5,18,i.isLoading$)&&0===i.filteredUserRequests.length&&0===i.filteredInsighterRequests.length&&!i.hasActiveFilters()),e.R7$(2),e.Y8G("ngIf",!e.bMT(7,20,i.isLoading$)&&i.userProfile&&i.userRequests.length>0),e.R7$(2),e.Y8G("ngIf",!e.bMT(9,22,i.isLoading$)&&i.insighterRequests.length>0),e.R7$(2),e.Aen(e.lJ4(26,x)),e.FS9("header",e.bMT(11,24,"USER_REQUESTS.DIALOG.HEADER")),e.R50("visible",i.displayRequestDialog),e.Y8G("modal",!0)("closable",!0),e.R7$(2),e.Y8G("ngIf",i.selectedRequest),e.R7$(),e.Y8G("ngIf","declined"===(null==i.selectedRequest?null:i.selectedRequest.final_status)&&!i.hasPendingRequestOfSameType&&!i.isInsighterRequest),e.R7$(),e.Y8G("ngIf",i.hasPendingRequestOfSameType&&"approved"!==(null==i.selectedRequest?null:i.selectedRequest.final_status)))},dependencies:[u.YU,u.Sq,u.bT,u.B3,R.l,h.xH,h.y7,h.me,h.wz,h.BC,h.vS,b.z,u.Jj,u.Pc,u.P9,u.PV,T.D9]})}return s})();var se=d(4133);const ie=[{path:"",component:te}];let ne=(()=>{class s{static \u0275fac=function(n){return new(n||s)};static \u0275mod=e.$C({type:s});static \u0275inj=e.G2t({imports:[u.MD,r.iI.forChild(ie),se.E,R.P,h.YN,b.d]})}return s})()},1579:(j,m,d)=>{d.d(m,{d:()=>F,z:()=>x});var u=d(177),r=d(4438),y=d(5779);const q=(o,_)=>({"p-progressbar p-component":!0,"p-progressbar-determinate":o,"p-progressbar-indeterminate":_}),E=(o,_)=>({width:o,display:"flex",background:_}),e=o=>({$implicit:o}),I=o=>({display:o}),S=o=>({background:o});function R(o,_){if(1&o&&(r.j41(0,"div",7),r.EFF(1),r.k0s()),2&o){const c=r.XpG(2);r.Y8G("ngStyle",r.eq3(4,I,null!=c.value&&0!==c.value?"flex":"none")),r.BMQ("data-pc-section","label"),r.R7$(),r.Lme(" ",c.value,"",c.unit," ")}}function h(o,_){1&o&&r.eu8(0)}function b(o,_){if(1&o&&(r.j41(0,"div",3)(1,"div",4),r.DNE(2,R,2,6,"div",5)(3,h,1,0,"ng-container",6),r.k0s()()),2&o){const c=r.XpG();r.Y8G("ngStyle",r.l_i(5,E,c.value+"%",c.color)),r.BMQ("data-pc-section","value"),r.R7$(2),r.Y8G("ngIf",c.showValue&&!c.contentTemplate),r.R7$(),r.Y8G("ngTemplateOutlet",c.contentTemplate)("ngTemplateOutletContext",r.eq3(8,e,c.value))}}function T(o,_){if(1&o&&(r.j41(0,"div",8),r.nrm(1,"div",3),r.k0s()),2&o){const c=r.XpG();r.BMQ("data-pc-section","container"),r.R7$(),r.Y8G("ngStyle",r.eq3(3,S,c.color)),r.BMQ("data-pc-section","value")}}let x=(()=>{class o{value;showValue=!0;styleClass;style;unit="%";mode="determinate";color;templates;contentTemplate;ngAfterContentInit(){this.templates?.forEach(c=>{c.getType(),this.contentTemplate=c.template})}static \u0275fac=function(p){return new(p||o)};static \u0275cmp=r.VBU({type:o,selectors:[["p-progressBar"]],contentQueries:function(p,g,k){if(1&p&&r.wni(k,y.Ei,4),2&p){let v;r.mGM(v=r.lsd())&&(g.templates=v)}},hostAttrs:[1,"p-element"],inputs:{value:[r.Mj6.HasDecoratorInputTransform,"value","value",r.Udg],showValue:[r.Mj6.HasDecoratorInputTransform,"showValue","showValue",r.L39],styleClass:"styleClass",style:"style",unit:"unit",mode:"mode",color:"color"},features:[r.GFd],decls:3,vars:14,consts:[["role","progressbar",3,"ngStyle","ngClass"],["class","p-progressbar-value p-progressbar-value-animate",3,"ngStyle",4,"ngIf"],["class","p-progressbar-indeterminate-container",4,"ngIf"],[1,"p-progressbar-value","p-progressbar-value-animate",3,"ngStyle"],[1,"p-progressbar-label"],[3,"ngStyle",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngStyle"],[1,"p-progressbar-indeterminate-container"]],template:function(p,g){1&p&&(r.j41(0,"div",0),r.DNE(1,b,4,10,"div",1)(2,T,2,5,"div",2),r.k0s()),2&p&&(r.HbH(g.styleClass),r.Y8G("ngStyle",g.style)("ngClass",r.l_i(11,q,"determinate"===g.mode,"indeterminate"===g.mode)),r.BMQ("aria-valuemin",0)("aria-valuenow",g.value)("aria-valuemax",100)("data-pc-name","progressbar")("data-pc-section","root"),r.R7$(),r.Y8G("ngIf","determinate"===g.mode),r.R7$(),r.Y8G("ngIf","indeterminate"===g.mode))},dependencies:[u.YU,u.bT,u.T3,u.B3],styles:['@layer primeng{.p-progressbar{position:relative;overflow:hidden}.p-progressbar-determinate .p-progressbar-value{height:100%;width:0%;position:absolute;display:none;border:0 none;display:flex;align-items:center;justify-content:center;overflow:hidden}.p-progressbar-determinate .p-progressbar-label{display:inline-flex}.p-progressbar-determinate .p-progressbar-value-animate{transition:width 1s ease-in-out}.p-progressbar-indeterminate .p-progressbar-value:before{content:"";position:absolute;background-color:inherit;top:0;left:0;bottom:0;will-change:left,right;-webkit-animation:p-progressbar-indeterminate-anim 2.1s cubic-bezier(.65,.815,.735,.395) infinite;animation:p-progressbar-indeterminate-anim 2.1s cubic-bezier(.65,.815,.735,.395) infinite}.p-progressbar-indeterminate .p-progressbar-value:after{content:"";position:absolute;background-color:inherit;top:0;left:0;bottom:0;will-change:left,right;-webkit-animation:p-progressbar-indeterminate-anim-short 2.1s cubic-bezier(.165,.84,.44,1) infinite;animation:p-progressbar-indeterminate-anim-short 2.1s cubic-bezier(.165,.84,.44,1) infinite;-webkit-animation-delay:1.15s;animation-delay:1.15s}}@-webkit-keyframes p-progressbar-indeterminate-anim{0%{left:-35%;right:100%}60%{left:100%;right:-90%}to{left:100%;right:-90%}}@keyframes p-progressbar-indeterminate-anim{0%{left:-35%;right:100%}60%{left:100%;right:-90%}to{left:100%;right:-90%}}@-webkit-keyframes p-progressbar-indeterminate-anim-short{0%{left:-200%;right:100%}60%{left:107%;right:-8%}to{left:107%;right:-8%}}@keyframes p-progressbar-indeterminate-anim-short{0%{left:-200%;right:100%}60%{left:107%;right:-8%}to{left:107%;right:-8%}}\n'],encapsulation:2,changeDetection:0})}return o})(),F=(()=>{class o{static \u0275fac=function(p){return new(p||o)};static \u0275mod=r.$C({type:o});static \u0275inj=r.G2t({imports:[u.MD]})}return o})()}}]);