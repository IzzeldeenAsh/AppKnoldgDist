"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[2059],{8688:(L,E,o)=>{o.d(E,{M:()=>C});var e=o(1626),m=o(4412),S=o(8810),u=o(6354),f=o(9437),h=o(980),p=o(4438),g=o(779);let C=(()=>{class _{http;translationService;apiUrl="https://api.knoldg.com/api/common/setting/consulting-field/tree/list";apiList="https://api.knoldg.com/api/common/setting/consulting-field/list";isLoadingSubject=new m.t(!1);isLoading$=this.isLoadingSubject.asObservable();currentLang="en";constructor(l,s){this.http=l,this.translationService=s,this.translationService.onLanguageChange().subscribe(d=>{this.currentLang=d||"en"})}setLoading(l){this.isLoadingSubject.next(l)}handleError(l){return(0,S.$)(l)}transformToTreeNode(l){return l.map(s=>({key:s.key,label:s.names[this.currentLang],data:{key:s.key,code:s.code,label:s.label,status:s.status,nameEn:s.names.en,nameAr:s.names.ar},children:s.children?this.transformToTreeNode(s.children):[]}))}transformToTreeNodeParent(l){return l.map(s=>({key:s.key,label:s.label,data:{key:s.key,code:s.code,label:s.label},children:s.children?this.transformToTreeNodeParent(s.children):[]}))}getConsultingCodesTree(l){const s=new e.Lr({Accept:"application/json","Content-Type":"application/json","Accept-Language":l});return this.setLoading(!0),this.http.get(this.apiUrl,{headers:s}).pipe((0,u.T)(d=>this.transformToTreeNode(d)),(0,f.W)(d=>this.handleError(d)),(0,h.j)(()=>this.setLoading(!1)))}getConsultingCodesTreeParent(l){const s=new e.Lr({Accept:"application/json","Content-Type":"application/json","Accept-Language":l});return this.setLoading(!0),this.http.get("https://api.knoldg.com/api/common/setting/consulting-field/tree/parent",{headers:s}).pipe((0,u.T)(d=>this.transformToTreeNodeParent(d)),(0,f.W)(d=>this.handleError(d)),(0,h.j)(()=>this.setLoading(!1)))}getConsultingList(l){const s=new e.Lr({Accept:"application/json","Content-Type":"application/json","Accept-Language":l});return this.setLoading(!0),this.http.get(this.apiList,{headers:s}).pipe((0,u.T)(d=>d.data),(0,f.W)(d=>this.handleError(d)),(0,h.j)(()=>this.setLoading(!1)))}createConsultingField(l,s){const d=new e.Lr({Accept:"application/json","Content-Type":"application/json","Accept-Language":s});return this.setLoading(!0),this.http.post("https://api.knoldg.com/api/admin/setting/consulting-field",l,{headers:d}).pipe((0,f.W)(this.handleError),(0,h.j)(()=>this.setLoading(!1)))}updateConsultingField(l,s,d){const y=new e.Lr({Accept:"application/json","Content-Type":"application/json","Accept-Language":d});return this.setLoading(!0),this.http.put(`https://api.knoldg.com/api/admin/setting/consulting-field/${l}`,s,{headers:y}).pipe((0,f.W)(this.handleError),(0,h.j)(()=>this.setLoading(!1)))}deleteIsicCode(l){const s=new e.Lr({Accept:"application/json","Content-Type":"application/json","Accept-Language":this.currentLang});return this.setLoading(!0),this.http.delete(`https://api.knoldg.com/api/admin/setting/consulting-field/${l}`,{headers:s}).pipe((0,f.W)(this.handleError),(0,h.j)(()=>this.setLoading(!1)))}static \u0275fac=function(s){return new(s||_)(p.KVO(e.Qq),p.KVO(g.L))};static \u0275prov=p.jDH({token:_,factory:_.\u0275fac,providedIn:"root"})}return _})()},7192:(L,E,o)=>{o.d(E,{Q:()=>C});var e=o(1626),m=o(4412),S=o(8810),u=o(6354),f=o(9437),h=o(980),p=o(4438),g=o(779);let C=(()=>{class _{http;translationService;apiUrl="https://api.knoldg.com/api/common/setting/insighter/document-type/list";isLoadingSubject=new m.t(!1);isLoading$=this.isLoadingSubject.asObservable();currentLang="en";documentTypes$;constructor(l,s){this.http=l,this.translationService=s,this.translationService.onLanguageChange().subscribe(d=>{this.currentLang=d||"en",this.documentTypes$=this.getDocumentsTypesFromApi()}),this.documentTypes$=this.getDocumentsTypesFromApi()}setLoading(l){this.isLoadingSubject.next(l)}handleError(l){return console.error("Error fetching document types:",l),(0,S.$)(l)}getDocumentsTypesFromApi(){const l=new e.Lr({Accept:"application/json","Content-Type":"application/json","Accept-Language":this.currentLang});return this.setLoading(!0),this.http.get(this.apiUrl,{headers:l}).pipe((0,u.T)(s=>s.data),(0,f.W)(s=>this.handleError(s)),(0,h.j)(()=>this.setLoading(!1)))}getDocumentsTypes(){return this.documentTypes$}static \u0275fac=function(s){return new(s||_)(p.KVO(e.Qq),p.KVO(g.L))};static \u0275prov=p.jDH({token:_,factory:_.\u0275fac,providedIn:"root"})}return _})()},5653:(L,E,o)=>{o.d(E,{o:()=>j});var e=o(4438),m=o(177),S=o(4412),u=o(3726),f=o(6354),h=o(9172),p=o(6781),g=o(7697),C=o(9417),_=o(2242),O=o(4827),l=o(3955),s=o(5779);const d=a=>({width:a,"max-height":"100vh",overflow:"hidden"}),y=()=>({"max-height":"calc(90vh - 100px)",overflow:"auto"}),A=()=>({"max-height":"100%",overflow:"auto"}),P=()=>({margin:"5px"});function b(a,T){if(1&a&&(e.qex(0),e.j41(1,"span"),e.EFF(2),e.k0s(),e.bVm()),2&a){const t=e.XpG().$implicit;e.R7$(2),e.JRh(t.label)}}function D(a,T){if(1&a){const t=e.RV6();e.qex(0),e.j41(1,"span"),e.EFF(2),e.k0s(),e.j41(3,"div",12)(4,"input",13),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG().$implicit;return e.DH7(r.data.customInput,n)||(r.data.customInput=n),e.Njj(n)}),e.bIt("input",function(){e.eBV(t);const n=e.XpG().$implicit,r=e.XpG();return e.Njj(r.onOtherInput(n))})("keypress",function(n){e.eBV(t);const r=e.XpG(2);return e.Njj(r.onKeyPress(n))}),e.k0s(),e.j41(5,"small",14),e.EFF(6),e.k0s()(),e.bVm()}if(2&a){const t=e.XpG().$implicit,i=e.XpG();e.R7$(2),e.JRh(t.label),e.R7$(2),e.R50("ngModel",t.data.customInput),e.Y8G("placeholder",i.otherFieldPlaceholder),e.R7$(2),e.SpI(" ","ar"===i.currentLang?"\u064a\u062c\u0628 \u0627\u0644\u0643\u062a\u0627\u0628\u0629 \u0628\u0627\u0644\u0639\u0631\u0628\u064a\u0629 \u0641\u0642\u0637":"Please write in English only"," ")}}function v(a,T){if(1&a&&e.DNE(0,b,3,1,"ng-container",10)(1,D,7,4,"ng-container",10),2&a){const t=T.$implicit;e.Y8G("ngIf",!t.isOther),e.R7$(),e.Y8G("ngIf",t.isOther)}}function M(a,T){if(1&a){const t=e.RV6();e.j41(0,"p-chip",16),e.bIt("onRemove",function(n){const r=e.eBV(t).$implicit;return e.XpG(2).onRemoveChip(r),e.Njj(n.stopPropagation())})("click",function(n){return e.eBV(t),e.Njj(n.stopPropagation())}),e.k0s()}if(2&a){const t=T.$implicit;e.Aen(e.lJ4(5,P)),e.Y8G("label",t.isOther&&t.data.customInput||t.label)("removable",!0)("styleClass","selection-chip")}}function N(a,T){if(1&a&&(e.qex(0),e.DNE(1,M,1,6,"p-chip",15),e.bVm()),2&a){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.getDisplayableSelectedNodes())}}function I(a,T){if(1&a&&(e.j41(0,"div",17),e.EFF(1),e.k0s()),2&a){const t=e.XpG();e.R7$(),e.SpI(" ",t.placeholder," ")}}let j=(()=>{class a{translate;title="Select Items";placeholder="Select...";otherFieldPlaceholder="Specify Other...";selectAllLabel="Select All";isRequired=!1;fetchedData=[];cancelLabel="Cancel";okLabel="OK";currentLang="en";initialSelectedNodes=[];nodesSelected=new e.bkB;dialogVisible=!1;dialogWidth="50vw";isLoading$=new S.t(!1);nodes=[];selectedNodes;committedNodes=[];unsubscribe=[];isSelectAllProcessing=!1;constructor(t){this.translate=t}ngOnInit(){this.committedNodes=[...this.initialSelectedNodes||[]],this.loadData(),this.handleWindowResize(),this.currentLang=this.translate.currentLang,console.log(this.currentLang)}ngOnDestroy(){this.unsubscribe.forEach(t=>t.unsubscribe())}loadData(){this.fetchedData?(this.nodes=this.addOtherOption([{key:"selectAll",label:this.selectAllLabel,data:{key:"selectAll",label:this.selectAllLabel},children:this.fetchedData,expanded:!0}]),this.reApplySelection()):console.error("fetchedData not provided or empty.")}addOtherOption(t,i=0){return t?t.map(n=>(n.children&&n.children.length>0&&(n.children=this.addOtherOption(n.children,i+1)),(0===i||1===i)&&(n.children=[...n.children||[],{key:`${n.key}-other`,label:"Other",data:{key:`${n.key}-other`,label:"Other"},isOther:!0,selectable:!1,children:[]}]),n)):[]}reApplySelection(){if(!this.committedNodes||0===this.committedNodes.length)return void(this.selectedNodes=[]);const t=this.flattenTree(this.nodes[0]),i=[];for(const n of this.committedNodes){const r=t.find(c=>c.key===n.key);r&&(r.isOther&&n.data?.customInput&&(r.data.customInput=n.data.customInput),i.push(r))}this.selectedNodes=i,this.updateSelectAllState()}onKeyPress(t){const i=t.key;if(t.ctrlKey||t.metaKey||i.length>1)return!0;if("ar"===this.currentLang){if(!/[\u0600-\u06FF\s]/.test(i))return t.preventDefault(),!1}else if(!/[a-zA-Z\s]/.test(i))return t.preventDefault(),!1;return!0}onOtherInput(t){t.data.customInput&&""!==t.data.customInput.trim()?this.selectedNodes.some(i=>i.key===t.key)||(this.selectedNodes=[...this.selectedNodes,t]):this.selectedNodes=this.selectedNodes.filter(i=>i.key!==t.key),this.updateSelectAllState()}getDisplayableSelectedNodes(){return this.committedNodes&&0!==this.committedNodes.length?this.committedNodes.filter(t=>"selectAll"!==t.key):[]}onRemoveChip(t){this.committedNodes&&(this.committedNodes=this.committedNodes.filter(n=>n.key!==t.key),0===this.committedNodes.filter(n=>"selectAll"!==n.key).length&&(this.committedNodes=this.committedNodes.filter(n=>"selectAll"!==n.key)),this.nodesSelected.emit(this.committedNodes))}selectedNodesLabel(){return this.committedNodes&&this.committedNodes.length>0?this.committedNodes.filter(i=>"selectAll"!==i.key).map(i=>i.isOther&&i.data.customInput?i.data.customInput:i.label).join(", "):""}showDialog(){this.reApplySelection(),this.dialogVisible=!0}onOk(){this.dialogVisible=!1,this.committedNodes=[...this.selectedNodes||[]],this.nodesSelected.emit(this.committedNodes)}onCancel(){this.dialogVisible=!1,this.reApplySelection()}onNodeSelect(t){this.isSelectAllProcessing||("selectAll"===t.node.key?this.toggleSelectAll(!0):this.updateSelectAllState())}onNodeUnselect(t){this.isSelectAllProcessing||("selectAll"===t.node.key?this.toggleSelectAll(!1):this.updateSelectAllState())}toggleSelectAll(t){if(!this.isSelectAllProcessing){if(this.isSelectAllProcessing=!0,t&&this.nodes.length>0){const i=this.flattenTree(this.nodes[0]);this.selectedNodes=i}else this.selectedNodes=[];this.isSelectAllProcessing=!1}}updateSelectAllState(){if(!this.nodes||0===this.nodes.length)return;const t=this.getAllChildNodes(this.nodes),i=new Set(this.selectedNodes.map(c=>c.key)),n=t.every(c=>i.has(c.key)),r=this.nodes.find(c=>"selectAll"===c.key);n?r&&!i.has(r.key)&&(this.isSelectAllProcessing=!0,this.selectedNodes=[r,...this.selectedNodes],this.isSelectAllProcessing=!1):r&&i.has(r.key)&&(this.isSelectAllProcessing=!0,this.selectedNodes=this.selectedNodes.filter(c=>"selectAll"!==c.key),this.isSelectAllProcessing=!1)}flattenTree(t,i=[]){return i.push(t),t.children&&t.children.forEach(n=>this.flattenTree(n,i)),i}getAllChildNodes(t){let i=[];return t.forEach(n=>{"selectAll"!==n.key&&(i.push(n),n.children&&n.children.length>0&&(i=i.concat(this.getAllChildNodes(n.children))))}),i}handleWindowResize(){const i=(0,u.R)(window,"resize").pipe((0,f.T)(()=>window.innerWidth),(0,h.Z)(window.innerWidth)).subscribe(n=>{this.dialogWidth=n<768?"100vw":"70vw"});this.unsubscribe.push(i)}static \u0275fac=function(i){return new(i||a)(e.rXU(l.c$))};static \u0275cmp=e.VBU({type:a,selectors:[["shared-tree-selector"]],inputs:{title:"title",placeholder:"placeholder",otherFieldPlaceholder:"otherFieldPlaceholder",selectAllLabel:"selectAllLabel",isRequired:"isRequired",fetchedData:"fetchedData",cancelLabel:"cancelLabel",okLabel:"okLabel",currentLang:"currentLang",initialSelectedNodes:"initialSelectedNodes"},outputs:{nodesSelected:"nodesSelected"},standalone:!0,features:[e.aNF],decls:17,vars:26,consts:[["appendTo","body",3,"visibleChange","header","visible","modal","contentStyle"],[1,"tree-container"],["selectionMode","checkbox","filterMode","strict",1,"industry-tree",3,"selectionChange","onNodeSelect","onNodeUnselect","onChange","value","selection","metaKeySelection","filter","loading"],["pTemplate","default"],[1,"p-2","d-flex","justify-content-between","align-items-center"],[1,"btn","btn-sm","btn-secondary","btn-shadow","cursor-pointer",3,"click"],[1,"btn","btn-sm","btn-primary","m-1","btn-shadow","cursor-pointer",3,"click"],[1,"col-12","mb-4"],[1,"form-label","fs-6","text-gray-900"],[1,"selected-nodes-container",3,"click"],[4,"ngIf"],["class","placeholder-text",4,"ngIf"],[2,"display","flex","flex-direction","column","width","70%","margin-left","10px"],["pInputText","","type","text",2,"width","100%",3,"ngModelChange","input","keypress","ngModel","placeholder"],[1,"text-muted",2,"font-size","0.75rem","margin-top","2px"],[3,"label","removable","styleClass","style","onRemove","click",4,"ngFor","ngForOf"],[3,"onRemove","click","label","removable","styleClass"],[1,"placeholder-text"]],template:function(i,n){1&i&&(e.j41(0,"p-dialog",0),e.mxI("visibleChange",function(c){return e.DH7(n.dialogVisible,c)||(n.dialogVisible=c),c}),e.j41(1,"div",1)(2,"p-tree",2),e.nI1(3,"async"),e.mxI("selectionChange",function(c){return e.DH7(n.selectedNodes,c)||(n.selectedNodes=c),c}),e.bIt("onNodeSelect",function(c){return n.onNodeSelect(c)})("onNodeUnselect",function(c){return n.onNodeUnselect(c)})("onChange",function(){return n.updateSelectAllState()}),e.DNE(4,v,2,2,"ng-template",3),e.k0s()(),e.j41(5,"p-footer")(6,"div",4)(7,"a",5),e.bIt("click",function(){return n.onCancel()}),e.EFF(8),e.k0s(),e.j41(9,"a",6),e.bIt("click",function(){return n.onOk()}),e.EFF(10),e.k0s()()()(),e.j41(11,"div",7)(12,"label",8),e.EFF(13),e.k0s(),e.j41(14,"div",9),e.bIt("click",function(){return n.showDialog()}),e.DNE(15,N,2,1,"ng-container",10)(16,I,2,1,"div",11),e.k0s()()),2&i&&(e.Aen(e.eq3(22,d,n.dialogWidth)),e.Y8G("header",n.title),e.R50("visible",n.dialogVisible),e.Y8G("modal",!0)("contentStyle",e.lJ4(24,y)),e.R7$(2),e.Aen(e.lJ4(25,A)),e.Y8G("value",n.nodes),e.R50("selection",n.selectedNodes),e.Y8G("metaKeySelection",!1)("filter",!0)("loading",e.bMT(3,20,n.isLoading$)),e.R7$(6),e.SpI(" ",n.cancelLabel," "),e.R7$(2),e.SpI(" ",n.okLabel," "),e.R7$(2),e.AVh("required",n.isRequired),e.R7$(),e.SpI(" ",n.title," "),e.R7$(2),e.Y8G("ngIf",n.getDisplayableSelectedNodes().length>0),e.R7$(),e.Y8G("ngIf",0===n.getDisplayableSelectedNodes().length))},dependencies:[m.MD,m.Sq,m.bT,m.Jj,p.P,p.l,s.wi,s.Ei,g.ft,g.PH,C.YN,C.me,C.BC,C.vS,_.u,_.S,O.P,O.v],styles:[".responsive-dialog[_ngcontent-%COMP%]{width:50vw;max-height:90vh;overflow:hidden}@media (max-width: 768px){.responsive-dialog[_ngcontent-%COMP%]{width:100vw}}.tree-container[_ngcontent-%COMP%]{height:500px;max-height:calc(-100px + 80vh)}.max-width-200px[_ngcontent-%COMP%]{max-width:250px;width:250px}.logo-placeholder[_ngcontent-%COMP%]{background-size:contain;background-position:center}.fit-content[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content}.selected-nodes-container[_ngcontent-%COMP%]{cursor:pointer;background-color:#fff;border:1px solid #DBDFE9;border-radius:.475rem;overflow-y:auto;padding:.5rem .75rem;min-height:3.5rem;max-height:6rem;display:flex;flex-wrap:wrap;align-items:flex-start;align-content:flex-start;position:relative}.dots[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0;font-size:1.5rem;color:#6c757d}.placeholder-text[_ngcontent-%COMP%]{color:#6c757d;padding:10px}[_nghost-%COMP%]     .read-only-chip .p-chips-input-token{display:none}[_nghost-%COMP%]     .read-only-chip .p-chips-token{margin:2px;background:#e9ecef;color:#495057}[_nghost-%COMP%]     .selection-chip{background-color:#f0f7ff;color:#0d6efd;border-radius:16px;font-size:.85rem}[_nghost-%COMP%]     .selection-chip .p-chip-remove-icon{color:#0d6efd}[_nghost-%COMP%]     .selection-chip .p-chip-remove-icon:hover{color:#0a58ca}[_nghost-%COMP%]     .selection-chip:hover{background-color:#e2f0ff}"],changeDetection:0})}return a})()},8807:(L,E,o)=>{o.d(E,{v:()=>S});var e=o(4438),m=o(461);let S=(()=>{class u extends m.h{static \u0275fac=(()=>{let h;return function(g){return(h||(h=e.xGo(u)))(g||u)}})();static \u0275cmp=e.VBU({type:u,selectors:[["ChevronRightIcon"]],standalone:!0,features:[e.Vt3,e.aNF],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M4.38708 13C4.28408 13.0005 4.18203 12.9804 4.08691 12.9409C3.99178 12.9014 3.9055 12.8433 3.83313 12.7701C3.68634 12.6231 3.60388 12.4238 3.60388 12.2161C3.60388 12.0084 3.68634 11.8091 3.83313 11.6622L8.50507 6.99022L3.83313 2.31827C3.69467 2.16968 3.61928 1.97313 3.62287 1.77005C3.62645 1.56698 3.70872 1.37322 3.85234 1.22959C3.99596 1.08597 4.18972 1.00371 4.3928 1.00012C4.59588 0.996539 4.79242 1.07192 4.94102 1.21039L10.1669 6.43628C10.3137 6.58325 10.3962 6.78249 10.3962 6.99022C10.3962 7.19795 10.3137 7.39718 10.1669 7.54416L4.94102 12.7701C4.86865 12.8433 4.78237 12.9014 4.68724 12.9409C4.59212 12.9804 4.49007 13.0005 4.38708 13Z","fill","currentColor"]],template:function(p,g){1&p&&(e.qSk(),e.j41(0,"svg",0),e.nrm(1,"path",1),e.k0s()),2&p&&(e.HbH(g.getClassNames()),e.BMQ("aria-label",g.ariaLabel)("aria-hidden",g.ariaHidden)("role",g.role))},encapsulation:2})}return u})()}}]);